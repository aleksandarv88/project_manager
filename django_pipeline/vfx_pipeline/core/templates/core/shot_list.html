{% extends 'core/base.html' %}
{% block title %}Shots{% endblock %}

{% block content %}
<h1>Shots</h1>
<a href="{% url 'add_shot' %}">➕ Add Shot</a>

<form id="filter_form" method="get">
    <label>Project:</label>
    <select name="project" id="project_select">
        <option value="">All</option>
        {% for project in projects %}
            <option value="{{ project.id }}" {% if project.id|stringformat:"s" == selected_project %}selected{% endif %}>
                {{ project.name }}
            </option>
        {% endfor %}
    </select>

    <label>Sequence:</label>
    <select name="sequence" id="sequence_select">
        <option value="">All</option>
        {% for seq in sequences %}
            {% if not selected_project or seq.project.id|stringformat:"s" == selected_project %}
                <option value="{{ seq.id }}" {% if seq.id|stringformat:"s" == selected_sequence %}selected{% endif %}>
                    {{ seq.name }}
                </option>
            {% endif %}
        {% endfor %}
    </select>
</form>

<ul>
    {% for shot in shots %}
    <li class="list-card">
        <a href="{% url 'edit_shot' shot.id %}" class="card-link" style="
            display: block;
            width: 100%;
            height: 100%;
            color: inherit;
            text-decoration: none;
            padding: 15px;
        ">
            {{ shot.name }}
            <br>Project: {{ shot.project.name }}
            <br>Sequence: {{ shot.sequence.name }}
            {% if shot.image %}
                <br><img src="{{ shot.image.url }}" alt="{{ shot.name }}" width="100">
            {% endif %}
        </a>
        <a href="{% url 'delete_shot' shot.id %}" class="delete-btn">❌ Delete</a>
    </li>
    {% empty %}
        <li>No shots found.</li>
    {% endfor %}
</ul>

<script>
    document.getElementById('project_select').addEventListener('change', function() {
        document.getElementById('filter_form').submit();
    });
    document.getElementById('sequence_select').addEventListener('change', function() {
        document.getElementById('filter_form').submit();
    });
</script>
{% endblock %}
