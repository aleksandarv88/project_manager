{% extends 'core/base.html' %}
{% block title %}Add Shot{% endblock %}
{% block content %}
<div class="form-card">
  <h2>Add Shot</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
      <label for="id_project">Project</label>
      {{ form.project }}
    </div>
    <div class="form-group">
      <label for="id_sequence">Sequence</label>
      {{ form.sequence }}
    </div>
    <div class="form-group">
      <label for="id_name">Shot Name</label>
      {{ form.name }}
    </div>
    <div class="form-group">
      <label for="id_image">Image</label>
      {{ form.image }}
    </div>
    <button type="submit" class="btn btn-secondary">Add Shot</button>
  </form>
  <p><a href="{% url 'shot_list' %}">â¬… Back to Shots</a></p>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
  $("#id_project").change(function() {
    var projectId = $(this).val();
    $.ajax({
      url: "{% url 'api_sequences' %}",
      data: {
        'project_id': projectId
      },
      success: function(data) {
        var select = $("#id_sequence");
        select.empty();
        select.append('<option value="">---------</option>');
        data.forEach(function(seq) {
          select.append('<option value="' + seq.id + '">' + seq.name + '</option>');
        });
      }
    });
  });
});
</script>
{% endblock %}
